{"ast":null,"code":"import _regeneratorRuntime from\"/home/slinky/course_work/stranger_things_project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _slicedToArray from\"/home/slinky/course_work/stranger_things_project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _asyncToGenerator from\"/home/slinky/course_work/stranger_things_project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React,{useState}from'react';import{Link}from'react-router-dom';import{BASE_URL}from'../constants';//TO DO\n// - When user logs in, save username the same way as token in Local Storage\n// - Make Login and Register links disappear\n// - When user logs out, fix the link that takes them to the log in screen\n// - \nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function login(_x,_x2,_x3){return _login.apply(this,arguments);}function _login(){_login=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(username,password,setToken){var response,result,token;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(BASE_URL+'users/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({user:{username:username,password:password}})});case 2:response=_context.sent;_context.next=5;return response.json();case 5:result=_context.sent;token=result.data.token;setToken(token);localStorage.setItem(\"token\",token);case 9:case\"end\":return _context.stop();}}},_callee);}));return _login.apply(this,arguments);}function register(_x4,_x5,_x6,_x7){return _register.apply(this,arguments);}function _register(){_register=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(setToken,username,password,confirmedPassword){var response,result,token;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(password!==confirmedPassword)){_context2.next=3;break;}alert(\"Passwords don't match\");return _context2.abrupt(\"return\");case 3:_context2.next=5;return fetch(BASE_URL+'users/register',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({user:{username:username,password:password}})});case 5:response=_context2.sent;console.log(response);_context2.next=9;return response.json();case 9:result=_context2.sent;token=result.data.token;setToken(token);localStorage.setItem(\"token\",token);case 13:case\"end\":return _context2.stop();}}},_callee2);}));return _register.apply(this,arguments);}var Login=function Login(_ref){var setToken=_ref.setToken,match=_ref.match,isLoggedIn=_ref.isLoggedIn,history=_ref.history;var _useState=useState(\"your username\"),_useState2=_slicedToArray(_useState,2),username=_useState2[0],setUsername=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),confirmedPassword=_useState6[0],setConfirmedPassword=_useState6[1];return/*#__PURE__*/_jsxs(\"form\",{onSubmit:function onSubmit(e){e.preventDefault();if(match.url===\"/register\")register(setToken,username,password,confirmedPassword);if(match.url===\"/login\")login(username,password,setToken);},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Username\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:username,onChange:function onChange(_ref2){var value=_ref2.target.value;return setUsername(value);},className:\"form-control\",id:\"exampleFormControlInput\",placeholder:\"your username\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",value:password,onChange:function onChange(_ref3){var value=_ref3.target.value;return setPassword(value);},className:\"form-control\",id:\"examleFormControlInput\",placeholder:\"\"})]}),match.url===\"/register\"?/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Confirm Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",onChange:function onChange(_ref4){var value=_ref4.target.value;return setConfirmedPassword(value);},value:confirmedPassword,className:\"form-control\",id:\"exampleFormControlInput\",placeholder:\"\"})]}):null,/*#__PURE__*/_jsxs(\"div\",{className:\"col-auto\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary mb-3\",onClick:function onClick(){isLoggedIn&&history.push(\"/home\");},children:\"Submit\"}),match.url===\"/register\"?/*#__PURE__*/_jsx(Link,{to:\"/login\",children:\" Already have an account?\"}):/*#__PURE__*/_jsx(Link,{to:\"/register\",children:\" Don't have an account?\"})]})]});};export default Login;","map":{"version":3,"sources":["/home/slinky/course_work/stranger_things_project/src/components/Login.js"],"names":["React","useState","Link","BASE_URL","login","username","password","setToken","fetch","method","headers","body","JSON","stringify","user","response","json","result","token","data","localStorage","setItem","register","confirmedPassword","alert","console","log","Login","match","isLoggedIn","history","setUsername","setPassword","setConfirmedPassword","e","preventDefault","url","value","target","push"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport { BASE_URL } from '../constants';\n\n//TO DO\n// - When user logs in, save username the same way as token in Local Storage\n// - Make Login and Register links disappear\n// - When user logs out, fix the link that takes them to the log in screen\n// - \n\nasync function login(username, password, setToken) {\n    const response = await fetch(BASE_URL + 'users/login', {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n            user: {\n                username,\n                password,\n            },\n        }),\n    })\n\n    const result = await response.json();\n    const token = result.data.token;\n    setToken(token);\n    localStorage.setItem(\"token\", token);\n}\n\nasync function register(setToken, username, password, confirmedPassword){\n    if (password !== confirmedPassword){\n        alert(\"Passwords don't match\");\n        return;\n    }\n    const response = await fetch(BASE_URL + 'users/register', {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n            user: {\n                username,\n                password,\n            },\n        }),\n    })\n    console.log(response)\n    const result = await response.json();\n    const token = result.data.token;\n    setToken(token);\n    localStorage.setItem(\"token\", token);\n}\n\nconst Login = ({ setToken, match, isLoggedIn, history }) => {\n    const [username, setUsername] = useState(\"your username\");\n    const [password, setPassword] = useState(\"\");\n    const [confirmedPassword, setConfirmedPassword] = useState(\"\");\n\n    return (\n        <form\n            onSubmit={(e) =>{\n                e.preventDefault();\n                if (match.url === \"/register\") register(setToken, username, password, confirmedPassword)\n                if (match.url === \"/login\") login(username, password, setToken)\n            }}\n        >\n            <div className=\"mb-3\">\n                <label className=\"form-label\">\n                    Username\n                </label>\n                <input\n                    type=\"text\"\n                    value={username}\n                    onChange={({target: {value}}) => setUsername(value)}\n                    className=\"form-control\"\n                    id=\"exampleFormControlInput\"\n                    placeholder=\"your username\"\n                />\n            </div>\n            <div className=\"mb-3\">\n                <label className=\"form-label\">\n                    Password\n                </label>\n                <input\n                    type=\"password\"\n                    value={password}\n                    onChange={({target: {value}}) => setPassword(value)}\n                    className=\"form-control\"\n                    id=\"examleFormControlInput\"\n                    placeholder=\"\"\n                />\n            </div>\n            {\n            match.url === \"/register\" ? (\n            <div className=\"mb-3\">\n                <label className=\"form-label\">\n                    Confirm Password\n                </label>\n                <input \n                    type=\"password\"\n                    onChange={({target: {value}}) => setConfirmedPassword(value)}\n                    value={confirmedPassword}\n                    className=\"form-control\"\n                    id=\"exampleFormControlInput\"\n                    placeholder=\"\"\n                />\n            </div>\n            ) : null}\n            <div className=\"col-auto\">\n                <button type=\"submit\" className=\"btn btn-primary mb-3\"\n                    onClick={() => {isLoggedIn && history.push(\"/home\")}}\n                >\n                    Submit\n                </button>\n                {\n                    match.url === \"/register\" ?\n                    <Link to=\"/login\"> Already have an account?</Link>\n                    : <Link to=\"/register\"> Don't have an account?</Link>\n                }\n            </div>\n        </form>\n    )\n}\n\nexport default Login;"]},"metadata":{},"sourceType":"module"}