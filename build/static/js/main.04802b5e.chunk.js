(this.webpackJsonpstranger_things_project=this.webpackJsonpstranger_things_project||[]).push([[0],{35:function(e,t,n){"use strict";n.r(t);var r=n(10),c=n(4),s=n(1),a=n(20),o=n.n(a),i=n(9),u=n(2),l=n(0),j=function(e){var t=e.page,n=e.setFilteredResults,r=Object(s.useState)(""),a=Object(c.a)(r,2),o=a[0],i=a[1];return Object(l.jsxs)("div",{children:[Object(l.jsx)("label",{children:"Search Posts"}),Object(l.jsx)("input",{value:o,onChange:function(e){i(e.target.value);var r=function(e,t){return t=t.toLowerCase(),e.filter((function(e,n){return e.title.toLowerCase().includes(t)}))}(t,e.target.value);n(r)},placeholder:"search"})]})},p=function(e){var t=e.isLoggedIn,n=e.history,r=e.page,a=Object(s.useState)(r),o=Object(c.a)(a,2),i=o[0],u=o[1];return Object(s.useEffect)((function(){u(r)}),[r]),Object(l.jsxs)("div",{children:[Object(l.jsx)(j,{page:r,setFilteredResults:u}),Object(l.jsx)("div",{children:i.map((function(e){return Object(l.jsxs)("div",{children:[Object(l.jsx)("h3",{children:e.title}),Object(l.jsx)("p",{children:e.description}),Object(l.jsxs)("p",{children:["Price: ",e.price]}),Object(l.jsxs)("p",{children:["Seller: ",e.author.username]}),Object(l.jsxs)("p",{children:["Location: ",e.location]}),t&&Object(l.jsx)("div",{children:Object(l.jsx)("button",{onClick:function(){n.push("/posts/"+e._id)},children:"Send Message"})})]},e._id)}))})]})},b=n(5),h=n.n(b),d=n(11),O="https://strangers-things.herokuapp.com/api/2107-CSU-RM-WEB-PT/";function f(){return(f=Object(d.a)(h.a.mark((function e(t,n,r){var c,s,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(O+"users/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:{username:t,password:n}})});case 2:return c=e.sent,e.next=5,c.json();case 5:s=e.sent,a=s.data.token,r(a),localStorage.setItem("token",a);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(){return(g=Object(d.a)(h.a.mark((function e(t,n,r,c){var s,a,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r===c){e.next=3;break}return alert("Passwords don't match"),e.abrupt("return");case 3:return e.next=5,fetch(O+"users/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:{username:n,password:r}})});case 5:return s=e.sent,console.log(s),e.next=9,s.json();case 9:a=e.sent,o=a.data.token,t(o),localStorage.setItem("token",o);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var x=function(e){var t=e.setToken,n=e.match,r=e.isLoggedIn,a=e.history,o=Object(s.useState)("your username"),u=Object(c.a)(o,2),j=u[0],p=u[1],b=Object(s.useState)(""),h=Object(c.a)(b,2),d=h[0],O=h[1],x=Object(s.useState)(""),m=Object(c.a)(x,2),v=m[0],y=m[1];return Object(l.jsxs)("form",{onSubmit:function(e){e.preventDefault(),"/register"===n.url&&function(e,t,n,r){g.apply(this,arguments)}(t,j,d,v),"/login"===n.url&&function(e,t,n){f.apply(this,arguments)}(j,d,t)},children:[Object(l.jsxs)("div",{className:"mb-3",children:[Object(l.jsx)("label",{className:"form-label",children:"Username"}),Object(l.jsx)("input",{type:"text",value:j,onChange:function(e){var t=e.target.value;return p(t)},className:"form-control",id:"exampleFormControlInput",placeholder:"your username"})]}),Object(l.jsxs)("div",{className:"mb-3",children:[Object(l.jsx)("label",{className:"form-label",children:"Password"}),Object(l.jsx)("input",{type:"password",value:d,onChange:function(e){var t=e.target.value;return O(t)},className:"form-control",id:"examleFormControlInput",placeholder:""})]}),"/register"===n.url?Object(l.jsxs)("div",{className:"mb-3",children:[Object(l.jsx)("label",{className:"form-label",children:"Confirm Password"}),Object(l.jsx)("input",{type:"password",onChange:function(e){var t=e.target.value;return y(t)},value:v,className:"form-control",id:"exampleFormControlInput",placeholder:""})]}):null,Object(l.jsxs)("div",{className:"col-auto",children:[Object(l.jsx)("button",{type:"submit",className:"btn btn-primary mb-3",onClick:function(){r&&a.push("/home")},children:"Submit"}),"/register"===n.url?Object(l.jsx)(i.b,{to:"/login",children:" Already have an account?"}):Object(l.jsx)(i.b,{to:"/register",children:" Don't have an account?"})]})]})};function m(){return(m=Object(d.a)(h.a.mark((function e(){var t,n,r,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.getItem("token"),e.next=3,fetch(O+"users/me",{headers:{"Content-Type":"application/json",Authorization:"BEARER "+t}});case 3:return n=e.sent,e.next=6,n.json();case 6:r=e.sent,c=r.data.username,localStorage.setItem("username",c);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var v=function(e){e.isLoggedIn,e.history,localStorage.getItem("token");var t=localStorage.getItem("username");return Object(s.useEffect)((function(){!function(){m.apply(this,arguments)}()}),[]),Object(l.jsxs)("div",{children:[Object(l.jsx)("h2",{children:"Welcome to Stranger's Things!"}),Object(l.jsxs)("h3",{children:["Logged in as ",t]}),Object(l.jsx)("button",{onClick:function(){fetch(O+"/users/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:{username:"",password:""}})}),localStorage.removeItem("token"),localStorage.removeItem("username")},children:"Logout"})]})},y=n(23),S=function(e){e.isLoggedIn;console.log("heyo");function t(){return t=Object(d.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:fetch(O+"/posts").then((function(e){return e.json()})).then((function(e){console.log(e)})).catch(console.error),t(result.data.posts);case 2:case"end":return e.stop()}}),e)}))),t.apply(this,arguments)}function n(e){return{"Content-Type":"application/json",Authorization:"Bearer"+e}}Object(s.useEffect)((function(){!function(e){t.apply(this,arguments)}()}),[]);var r=Object(s.useState)([]),a=Object(c.a)(r,2),o=a[0],i=a[1],u=Object(s.useState)(""),j=Object(c.a)(u,2),p=j[0],b=j[1],f=Object(s.useState)(""),g=Object(c.a)(f,2),x=g[0],m=g[1],v=Object(s.useState)(""),S=Object(c.a)(v,2),k=S[0],w=S[1],C=Object(s.useState)(""),I=Object(c.a)(C,2),N=I[0],T=I[1],L=Object(s.useState)(!1),P=Object(c.a)(L,2),E=P[0],R=P[1];return Object(l.jsxs)("div",{children:[Object(l.jsx)("h1",{children:" Create a new post "}),Object(l.jsxs)("form",{onSubmit:function(){var e=Object(d.a)(h.a.mark((function e(t){var r,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,fetch("https://strangers-things.herokuapp.com/api/2107-CSU-RM-WEB-PT//posts",{method:"POST",header:n(token),body:JSON.stringify({title:p,description:x,price:k,location:N,willDeliver:E})});case 4:return r=e.sent,e.next=7,r.json();case 7:c=e.sent,i([].concat(Object(y.a)(o),[c.data.name])),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.error(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),children:[Object(l.jsx)("input",{type:"text",placeholder:"title",value:p,onChange:function(e){b(e.target.value)}}),Object(l.jsx)("input",{type:"text",placeholder:"description",value:x,onChange:function(e){m(e.target.value)}}),Object(l.jsx)("input",{type:"text",placeholder:"price",value:k,onChange:function(e){w(e.target.value)}}),Object(l.jsx)("input",{type:"text",placeholder:"location",value:N,onChange:function(e){T(e.target.value)}}),Object(l.jsx)("input",{type:"checkbox",value:E,onChange:function(e){R(e.target.value)},children:"Will Deliver?"})]})]})},k=function(){return Object(l.jsx)("h1",{children:"Heyo"})};function w(){return(w=Object(d.a)(h.a.mark((function e(){var t,n,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O+"/posts",e.prev=1,e.next=4,fetch("https://strangers-things.herokuapp.com/api/2107-CSU-RM-WEB-PT//posts");case 4:return t=e.sent,e.next=7,t.json();case 7:return n=e.sent,r=n.data.posts,e.abrupt("return",r);case 12:e.prev=12,e.t0=e.catch(1),console.error(e.t0);case 15:case"end":return e.stop()}}),e,null,[[1,12]])})))).apply(this,arguments)}var C=function(){var e=Object(s.useState)(null),t=Object(c.a)(e,2),n=t[0],a=t[1],o=Object(s.useState)([]),j=Object(c.a)(o,2),b=j[0],h=j[1];return Object(s.useEffect)((function(){(function(){return w.apply(this,arguments)})().then((function(e){return h(e)}))}),[]),Object(s.useEffect)((function(){var e=localStorage.getItem("token");e&&a(e)}),[]),Object(l.jsxs)(i.a,{children:[Object(l.jsx)(i.b,{to:"/login",children:"Login"}),Object(l.jsx)(i.b,{to:"/home",children:"Home"}),Object(l.jsx)(i.b,{to:"/posts",children:"Posts"}),Object(l.jsx)(i.b,{to:"/profile",children:"Profile"}),Object(l.jsx)(i.b,{to:"/register",children:"Register"}),Object(l.jsx)(i.b,{to:"/newposts",children:"New Post"}),Object(l.jsx)(u.a,{path:"/login",render:function(e){return Object(l.jsx)(x,Object(r.a)(Object(r.a)({},e),{},{setToken:a,isLoggedIn:!!n}))}}),Object(l.jsx)(u.a,{path:"/register",render:function(e){return Object(l.jsx)(x,Object(r.a)(Object(r.a)({},e),{},{setToken:a,isLoggedIn:!!n}))}}),Object(l.jsx)(u.a,{path:"/home",render:function(e){return Object(l.jsx)(v,Object(r.a)(Object(r.a)({},e),{},{isLoggedIn:!!n,token:n}))}}),Object(l.jsx)(u.a,{path:"/posts",render:function(e){return Object(l.jsx)(p,Object(r.a)(Object(r.a)({},e),{},{page:b,isLoggedIn:!!n}))}}),Object(l.jsx)(u.a,{path:"/posts/:postId",render:function(e){return Object(l.jsx)(k,Object(r.a)({},e))}}),Object(l.jsx)(u.a,{path:"newposts",render:function(e){return Object(l.jsx)(S,Object(r.a)(Object(r.a)({},e),{},{isLoggedIn:!!n}))}})]})};o.a.render(Object(l.jsx)(C,{}),document.getElementById("app"))}},[[35,1,2]]]);
//# sourceMappingURL=main.04802b5e.chunk.js.map